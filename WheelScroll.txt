Redirect Scrool Function  スクロール制御 (WheelScroll.ahk)
    単体/組込み両対応 (常駐専用)

.■動作環境
    AutoHotkey(_L)   マウスフックの使用できる環境
    動作確認環境: XP、7、8、8.1
    ※高解像度ディスプレイのdpi拡大表示には対応してません

.■概要
    ホイールリダイレクト。非アクティブウィンドウをホイール可能にします。あと加速とか。
    通常のホイールでスクロールできないウィンドウ、コントロールを互換スクロールモードで
    縦横スクロール可能

.■特徴
   ・スクロールバーのハンドルを取得して指定（互換スクロール時）
     → 分割ウィンドウ領域 (MS-Word Excel)
     → ホイールで動かないアプリ VisualBasicEditorなどのスクロールが可能に。
   ・スクロールバーの検知方法はWheel Redirectorっぽい設定で指定（互換スクロール時）
   ・ついでに秀丸の分割ウィンドウでもリダイレクト可能に

.■使用方法

..◆単体起動
   スクリプトをそのまま実行

..◆組込み
   AutoHotkey.iniなどに組込んで使う場合、AutoExecute セクションに

     #Include WheelScroll.ahk
     Gosub,WheelInit

   を入れる。

.■設定関係
..初期化ルーチン WheelInitを適当にカスタマイズして使用して下さい。
   ホイールモード：ホイール操作時、ホイールコマンドを投げる。
   互換モード：ホイール操作時、スクロールコマンドを投げる。ホイール未対応コントロールなどで有効
   互換モード カスタム動作：
      スクロールバーオブジェクトはスクロール対象コントロールに内包されているものが一般的ですが
      稀に並列だったり（萌ディタ）、1階層上のコントロールが対象だったりします（MS-Word）
      動かないソフトなどは Winspectorなどで調べて適当に追加してみると上手くいくかもしれません。

..Hotkey（デフォルト）
  ホイールUp/Downでホイールリダイレクト、Shift+ホイールで横スクロール
  (Logicoolマウス用のチルトテストサンプル、F11～F14 コメント外して使って下さい
  また、マウスドライバ側でもキー設定を弄る必要あり）

  適宜変更して下さい

.■制限事項等
    ホイールスクロールはできるだけアクティブ状態を替えず（非アクティブ時は非アクティブのまま）
    行うようにしてます。
    ※ Excelは互換モードではクラッシュしやすいようです
       動作に支障がでるようなら互換モードは避けてホイールモードで動かして下さい。

   マウスポインタがスクロールバー上にある時は正しく動作しないかも知れません。

.■改変・再配布
    改変・再配布ともにご自由にどうぞ
    (スクリプト中のAboutメッセージは適時書き換えて下さい)

.■履歴
    2005.02.10  なんか色々やろうとして複雑になりすぎて挫折

    2007.10.12 過去に作ったサブルーチン集のFunction化
               設定とか凝るのをやめて単純化、Initルーチンで適当に弄れるように。
               何かいつのまにかAHKでコントロールのハンドルが取れるようになってたので
               スクロールのハンドルとか取得してみる

    2008.03.03  ロジクールのチルトマウスで横スクロールさせてみるテスト(F11～F14)
                あんまり実用性ないかも。

    2008.05.20 ・互換モードリストに Access97追加 (51行目のコメント外して使って下さい）
               ・基本動作モードのデフォルト値を 1:互換SCROLL → 0:WHELL に。
                (今時はホイールの効かないアプリの方が少ないだろうということで)
               ・コメントとか所々説明の変なとこ修正

    2008.05.25 ・コントロールクラスが取れない時はウィンドウクラスを指定するようにした。
                 (Vieas メインウィンドウ用対策)

    2008.05.25 ・コントロールクラスが取れない時はウィンドウクラスを指定するようにした。

    2009.06.12 ・マルチディスプレイ対策 (Thanks IKKIさん) (非公開)

    2009.07.22 ・ 秀丸v8対応
               ・IKKI氏(http://www18.big.or.jp/~fujiwara/ikki/)の WheelAccel.ahk の
                 加速モードを入れ込み、オプションで選択できるようにした。
               ・Excelスクロール時にアクティブにならないようにした
                 (TrackWheelの旧バージョンから拝借)

	2012.11.08  U64対応 Uint → Ptrに置換、エンコードをUTF-8に変更
			    ※高解像度ディスプレイのdpi拡大表示には対応してません